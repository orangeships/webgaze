# 基于3D仿射变换的捏合动作判断优化计划

## 1. 当前算法局限性分析

* 仅使用2D坐标，忽略深度信息，导致不同角度和距离下判断不准确

* 基于简单距离阈值，未考虑手势空间姿态

* 固定阈值，未根据手部大小和距离自适应调整

* 未考虑手指3D空间关系，易产生误判

## 2. 优化方案设计

### 2.1 创建独立的3D坐标映射模块

* 文件：`src/hand_tracking/3d_affine_transformer.py`

* 实现3D仿射变换功能，用于手部关键点的空间映射

* 提供3D距离计算、姿态估计等辅助函数

### 2.2 优化手指关键点空间位置计算

* 利用MediaPipe已提供的3D关键点数据

* 实现基于3D仿射变换的坐标归一化

* 考虑手部姿态和深度信息，提高关键点位置准确性

### 2.3 改进捏合动作判断逻辑

* 基于3D距离计算指尖距离

* 考虑手指的3D空间角度关系

* 实现自适应阈值调整，根据手部大小动态调整

* 增加角度约束，提高判断准确性

### 2.4 调整捏合阈值参数

* 基于3D空间距离的相对阈值

* 考虑手指关节角度的约束条件

* 增加稳定性判断，减少误判

## 3. 实现步骤

1. **创建3D仿射变换模块**：实现3D坐标映射、距离计算、姿态估计等功能
2. **修改hand\_tracking\_system.py**：

   * 引入3D关键点数据

   * 集成3D仿射变换模块

   * 优化捏合判断逻辑

   * 调整阈值参数
3. **测试验证**：使用提供的视频文件进行测试

## 4. 技术要点

* 严格遵循独立实现原则，不引用lazer目录下的任何文件

* 基于MediaPipe的3D关键点数据进行计算

* 实现自适应阈值调整机制

* 考虑不同手势角度和距离的适应性

* 保持原有代码结构不变，仅优化捏合判断逻辑

## 5. 预期效果

* 提高捏合动作判断的准确性

* 增强对不同手势角度和距离的适应性

* 减少误判和漏判

* 保持实时性能

## 6. 测试计划

使用提供的`WIN_Pro.mp4`文件进行测试，验证优化后的捏合判断逻辑在不同场景下的表现。
